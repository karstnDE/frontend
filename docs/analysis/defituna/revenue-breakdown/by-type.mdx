---
title: Revenue by Type
---

import BrowserOnly from '@docusaurus/BrowserOnly';
import LoadingSpinner from '@site/src/components/common/LoadingSpinner';

# Revenue Breakdown by Transaction Type

Displays protocol revenue categorized by transaction operations, revealing which types of activities generate treasury inflows. Transaction types include protocol fees, position management, liquidations, and other revenue-generating operations. Click on a transaction type bar to display the top 10 contributing transactions for that type.

## Data

<BrowserOnly fallback={<LoadingSpinner />}>
  {() => {
    const { useState, useEffect } = require('react');
    const { useDashboardData } = require('@site/src/components/Dashboard/useDashboardData');
    const BreakdownChart = require('@site/src/components/Dashboard/BreakdownChart').default;
    const TopTransactionsTable = require('@site/src/components/Dashboard/TopTransactionsTable').default;

    function RevenueDashboard() {
      const data = useDashboardData();
      const [selectedId, setSelectedId] = useState(null);
      const [selectedLabel, setSelectedLabel] = useState(null);

      const handleBarClick = (id, label) => {
        setSelectedId(id);
        setSelectedLabel(label);
      };

      const clearFilter = () => {
        setSelectedId(null);
        setSelectedLabel(null);
      };

      // Fix scroll position after component loads
      useEffect(() => {
        if (!data.loading && window.location.hash) {
          setTimeout(() => {
            const id = window.location.hash.slice(1);
            const element = document.getElementById(id);
            if (element) {
              element.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
          }, 100);
        }
      }, [data.loading]);

      if (data.loading) {
        return <LoadingSpinner />;
      }

      if (data.error) {
        return (
          <div style={{
            padding: '32px',
            background: 'var(--ifm-background-surface-color)',
            border: '1px solid var(--ifm-color-danger)',
            borderRadius: 'var(--ifm-global-radius)',
            color: 'var(--ifm-color-danger)',
          }}>
            <div style={{ fontSize: '1.25rem', fontWeight: 600, marginBottom: '8px' }}>Error Loading Dashboard</div>
            <p>{data.error}</p>
          </div>
        );
      }

      const summary = data.summary;
      if (!summary) {
        return <div>No data available</div>;
      }

      return (
        <div>
          {/* Chart Section */}
          <BreakdownChart
            summary={summary}
            groupMode="type"
            onBarClick={handleBarClick}
          />

          {/* Table Section - appears under "Top Transactions Table" heading below */}
          <div id="transactions-table-section" style={{ marginTop: '32px' }}>
            <h2 id="top-transactions">Top Transactions Table</h2>

            <p style={{ marginBottom: '16px' }}>
              The table displays individual transactions contributing to treasury revenue.
              By default, it shows all transactions across all types, sorted by SOL amount.
            </p>

            <p style={{ marginBottom: '16px' }}>
              <strong>Filtering</strong>: Click any bar in the chart above to filter the table to that specific transaction type's transactions.
            </p>

            {selectedLabel && (
              <div style={{
                marginBottom: '16px',
                display: 'flex',
                alignItems: 'center',
                gap: '12px'
              }}>
                <span style={{ fontSize: '14px', color: 'var(--ifm-color-secondary)' }}>
                  Filtered by: <strong>{selectedLabel}</strong>
                </span>
                <button
                  onClick={clearFilter}
                  style={{
                    padding: '6px 12px',
                    fontSize: '13px',
                    background: 'var(--ifm-color-emphasis-200)',
                    border: '1px solid var(--ifm-toc-border-color)',
                    borderRadius: 'var(--ifm-global-radius)',
                    cursor: 'pointer',
                    color: 'var(--ifm-font-color-base)',
                  }}
                >
                  Clear Filter
                </button>
              </div>
            )}

            <TopTransactionsTable
              topTransactionsToken={data.topTransactionsToken}
              topTransactionsType={data.topTransactionsType}
              topTransactionsPool={data.topTransactionsPool}
              groupMode="type"
              selectedFilter={selectedId}
              selectedFilterLabel={selectedLabel}
              summary={summary}
            />
          </div>
        </div>
      );
    }

    return <RevenueDashboard />;
  }}
</BrowserOnly>

## Use Cases

This chart helps you:

- **Identify revenue drivers**: Understand which protocol operations generate the most income
- **Analyze operation mix**: Track the balance between different revenue-generating activities (fees, positions, liquidations)
- **Monitor protocol evolution**: See how revenue sources shift as the protocol matures
- **Cross-reference operations**: Link transaction types with [token](./by-token) and [pool](./by-pool) breakdowns
- **Investigate specific types**: Click bars to examine individual transactions for any transaction type

## How to Read This Chart

- **Bar height**: Each transaction type's total revenue contribution in SOL
- **X-axis**: Transaction type categories (labels may be truncated for display)
- **Y-axis**: Revenue amount in SOL
- **Transaction types**: Include protocol fees, position management, liquidations, and other operations
- **Interactions**:
  - Click on bars to filter the transaction table below
  - Hover over bars to see exact SOL amounts and type names
  - Transaction signatures in the table link to Solscan for detailed exploration

## Methodology

<details>
<summary>Click to expand technical details</summary>

**Data Sources**

- **Treasury transactions**: On-chain data from DefiTuna treasury PDA (`G9XfJoY81n8A9bZKaJFhJYomRrcvFkuJ22em2g8rZuCh`)
- **Classification system**: Log-based transaction analysis with [100% attribution accuracy](/analysis/data-quality)
- **Type definitions**: Configured pattern matching rules maintained in the backend

For complete pipeline details, see [Data Pipeline](/analysis/methodology).

**Classification System**

All transactions are classified using **log-based pattern matching**:

1. **Log extraction**: Transaction logs contain instruction names from on-chain programs
2. **Pattern matching**: Instructions are matched against known patterns in the classification configuration
3. **Type assignment**: Each transaction receives exactly one type classification
4. **Revenue filtering**: Non-revenue types (staking deposits, system operations) are excluded

The classification engine examines program execution logs to identify transaction purposes. This approach provides deterministic, auditable classification.

**Common Transaction Types**

- **Protocol Fees**: Revenue from fee collection across various operations
- **Position Management**: Income from opening, closing, and managing liquidity positions
- **Liquidations**: Proceeds from liquidating underwater positions
- **Compound Operations**: Automated fee compounding activities
- **Other Operations**: Additional protocol-specific revenue sources

**Revenue Filtering**

Excluded from revenue totals:
- **Staking operations**: User deposits (withdrawable, not revenue)
- **SwapReward transactions**: Conversion operations (attribution handled separately)
- **System transactions**: Operational overhead

See the [revenue attribution system](/analysis/methodology#token-normalization) for details on how SwapReward conversions attribute back to original transaction types.

**Update Frequency**

Data is automatically updated once a day. Check the "Last updated" timestamp in the site header for data freshness.

**Known Limitations**

- Classification logic updates require historical data reprocessing to maintain consistency
- New transaction types may initially be classified as "unknown" until patterns are added to the configuration
- Types with minimal revenue contribution may be grouped into "Other" category
- Chart shows cumulative data; individual transaction dates available in the table

</details>
