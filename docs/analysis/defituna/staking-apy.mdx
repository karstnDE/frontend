---
title: TUNA Staking APR
---

import BrowserOnly from '@docusaurus/BrowserOnly';
import LoadingSpinner from '@site/src/components/common/LoadingSpinner';

# TUNA Staking APR

This dashboard shows the historical development of the Annual Percentage Rate (APR) for staking TUNA tokens, calculated based on the DefiTuna protocol's treasury revenue.

## Current Statistics

<BrowserOnly fallback={<LoadingSpinner />}>
  {() => {
    const { useEffect, useState } = require('react');

    function ApySummaryStats() {
      const [data, setData] = useState(null);
      const [loading, setLoading] = useState(true);
      const [userEntryPrice, setUserEntryPrice] = useState(null);

      useEffect(() => {
        // Load APR data
        fetch('/data/apr_data.json')
          .then(response => response.json())
          .then(jsonData => {
            setData(jsonData);
            setLoading(false);
          })
          .catch(err => {
            console.error('Error loading APR summary:', err);
            setLoading(false);
          });

        // Load user entry price from localStorage, default to 0.05 (public pre-sale price)
        const saved = localStorage.getItem('tunaEntryPrice');
        if (saved && !isNaN(parseFloat(saved))) {
          setUserEntryPrice(parseFloat(saved));
        } else {
          setUserEntryPrice(0.05);
        }

        // Listen for storage changes to sync across components
        const handleStorageChange = () => {
          const newSaved = localStorage.getItem('tunaEntryPrice');
          if (newSaved && !isNaN(parseFloat(newSaved))) {
            setUserEntryPrice(parseFloat(newSaved));
          } else {
            setUserEntryPrice(null);
          }
        };

        window.addEventListener('storage', handleStorageChange);
        // Also listen for custom event for same-page updates
        window.addEventListener('tunaEntryPriceChanged', handleStorageChange);

        return () => {
          window.removeEventListener('storage', handleStorageChange);
          window.removeEventListener('tunaEntryPriceChanged', handleStorageChange);
        };
      }, []);

      if (loading) {
        return <div style={{ padding: '24px', textAlign: 'center', color: 'var(--ifm-color-secondary)' }}>Loading summary statistics...</div>;
      }

      if (!data || !data.summary || Object.keys(data.summary).length === 0) {
        return <div style={{ padding: '24px', textAlign: 'center', color: 'var(--ifm-color-secondary)' }}>No summary statistics available</div>;
      }

      const summary = data.summary;

      // Calculate custom APR stats if user entry price differs from default
      let customStats = null;
      if (userEntryPrice !== null && userEntryPrice > 0 && userEntryPrice !== 0.05 && data.daily_apr) {
        const customAprValues = data.daily_apr
          .filter(d => d.revenue_per_tuna_usd)
          .map(d => (d.revenue_per_tuna_usd / userEntryPrice) * 100);

        if (customAprValues.length > 0) {
          // Calculate 30-day average (last 30 values)
          const last30Values = customAprValues.slice(-30);

          customStats = {
            thirty_day_average: last30Values.reduce((a, b) => a + b, 0) / last30Values.length,
            historical_average: customAprValues.reduce((a, b) => a + b, 0) / customAprValues.length,
          };
        }
      }

      const StatCard = ({ label, referenceValue, yourValue, customValue, showIndicators }) => {
        const entryPrice = userEntryPrice || 0.05;
        const aprValue = customValue !== null && customValue !== undefined ? customValue : yourValue;

        // Format entry price without trailing zeroes
        const formatPrice = (price) => {
          return parseFloat(price.toFixed(4)).toString();
        };

        return (
          <div style={{
            padding: '16px 20px',
            background: 'var(--ifm-background-surface-color)',
            border: '1px solid var(--ifm-toc-border-color)',
            borderRadius: 'var(--ifm-global-radius)',
            boxShadow: '0 4px 16px rgba(15, 20, 27, 0.05)',
            display: 'flex',
            flexDirection: 'column',
            gap: '8px',
          }}>
            {/* Row 1: Label with optional teal line indicator */}
            <div style={{ fontSize: '16px', color: 'var(--ifm-color-secondary)', fontWeight: '600' }}>
              {label}{showIndicators && (
                <span style={{ marginLeft: '8px' }}>
                  (<span style={{
                    display: 'inline-block',
                    position: 'relative',
                    width: '35px',
                    height: '2px',
                    backgroundColor: 'rgba(0, 163, 180, 1)',
                    verticalAlign: 'middle'
                  }}>
                    <span style={{
                      position: 'absolute',
                      top: '50%',
                      left: '50%',
                      transform: 'translate(-50%, -50%)',
                      width: '6px',
                      height: '6px',
                      backgroundColor: 'rgba(0, 163, 180, 0.8)',
                      borderRadius: '50%'
                    }}></span>
                  </span>)
                </span>
              )}
            </div>

            {/* Row 2: Reference APR */}
            <div style={{ fontSize: '32px', fontWeight: '600', color: 'var(--accent)' }}>
              {referenceValue?.toFixed(2)}%
            </div>

            {/* Row 3: Entry Price APR with optional green line indicator */}
            <div style={{ fontSize: '14px', color: 'var(--ifm-color-emphasis-600)' }}>
              APR with ${formatPrice(entryPrice)} TUNA entry price: <strong style={{ color: 'var(--ifm-color-emphasis-600)' }}>{aprValue?.toFixed(2)}%</strong>{showIndicators && (
                <span style={{ marginLeft: '6px' }}>
                  (<span style={{
                    display: 'inline-block',
                    position: 'relative',
                    width: '30px',
                    height: '2px',
                    backgroundColor: 'rgba(34, 197, 94, 1)',
                    verticalAlign: 'middle'
                  }}>
                    <span style={{
                      position: 'absolute',
                      top: '50%',
                      left: '50%',
                      transform: 'translate(-50%, -50%)',
                      width: '5px',
                      height: '5px',
                      backgroundColor: 'rgba(34, 197, 94, 0.8)',
                      borderRadius: '50%'
                    }}></span>
                  </span>)
                </span>
              )}
            </div>
          </div>
        );
      };

      return (
        <div style={{
          display: 'grid',
          gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))',
          gap: '16px',
          marginBottom: '32px',
        }}>
          <StatCard
            label="30-day Average APR"
            referenceValue={summary.thirty_day_average_reference_apr}
            yourValue={summary.thirty_day_average_your_apr}
            customValue={customStats?.thirty_day_average}
            showIndicators={true}
          />
          <StatCard
            label="All-time Average APR"
            referenceValue={summary.historical_average_reference_apr}
            yourValue={summary.historical_average_your_apr}
            customValue={customStats?.historical_average}
            showIndicators={false}
          />
        </div>
      );
    }

    return <ApySummaryStats />;
  }}
</BrowserOnly>

## APR Development Over Time

<BrowserOnly fallback={<LoadingSpinner />}>
  {() => {
    const ApyChart = require('@site/src/components/Dashboard/ApyChart').default;
    return <ApyChart />;
  }}
</BrowserOnly>

:::info TUNA Reference Price
The chart includes an optional **TUNA Reference Price** trace (hidden by default - click the legend to show it). This price is derived from on-chain swap transaction data in the treasury's daily assets analysis. For each day, we analyze all TUNA/WSOL swap transactions, calculate weighted average prices based on trade volumes, and convert to USD. This gives us a reliable, data-driven price reference that reflects actual on-chain trading activity.
:::

## Methodology

The TUNA staking APR is calculated using the following approach:

### Key Parameters

- **TUNA Supply**: Fixed at 1,000,000,000 tokens
- **Rolling Window**: Up to 30 days of historical revenue data
- **Revenue Source**: Treasury WSOL inflows (validated against DefiTuna API)
- **TUNA Reference Price**:
  - **Source**: Daily `assets.json` files - derived from on-chain TUNA/WSOL swap transaction data
  - **Calculation**: Weighted average price based on swap volumes, converted to USD
- **Default Entry Price**: $0.05 (public pre-sale price)
- **USD/SOL Rates**: Daily spot rates derived from DefiTuna staking revenue API

### Calculation Formula

The APR calculation follows these steps:

1. **Rolling Revenue Sum**: Sum of treasury WSOL inflows over the last 30 days (or fewer for early dates)

2. **Annualized Revenue (USD)**:
   ```
   Annualized Revenue USD = (Rolling Revenue Sum USD / Days in Window) × 365
   ```

3. **Revenue per TUNA (USD)**:
   ```
   Revenue per TUNA USD = Annualized Revenue USD / 1,000,000,000
   ```

4. **Reference APR** (based on TUNA Reference Price):
   ```
   Reference APR (%) = (Revenue per TUNA USD / TUNA Reference Price USD) × 100
   ```

5. **Entry Price APR** (based on your entry price):
   ```
   Entry Price APR (%) = (Revenue per TUNA USD / Your Entry Price USD) × 100
   ```

### Example Calculation

For a given day with the following data:
- 30-day rolling revenue: $1,850,787 USD
- TUNA Reference Price: $0.0624 USD (from on-chain swap data)
- Your entry price: $0.05 USD (default)

The APR would be calculated as:
```
Annualized Revenue = ($1,850,787 / 30) × 365 = $22,509,605 USD
Revenue per TUNA = $22,509,605 / 1,000,000,000 = $0.02251 USD

Reference APR = ($0.02251 / $0.0624) × 100 = 36.07%
Entry Price APR = ($0.02251 / $0.05) × 100 = 45.02%
```

This shows how early investors with a lower entry price achieve higher APR on the same protocol revenue.

### USD Conversion Methodology

**Daily Spot Rates (Current)**:

As of January 2025, USD values are calculated using **daily spot market rates** fetched from the DefiTuna API. This ensures our USD calculations match the protocol's official values with 100% accuracy.

- **API Endpoint**: `https://api.defituna.com/api/v1/stats/staking/revenue`
- **Rate Calculation**: For each day, USD/SOL rate = (daily USD deposits) / (daily SOL deposits)
- **Accuracy**: 100% match with DefiTuna API (verified daily)

**Example**: On October 10, 2025, the spot rate was $181.11/SOL, so 926.36 SOL revenue = $167,771.22 USD.

**Previous Approach** (deprecated): Used a single historical average rate ($198.98/SOL) for all dates, which caused USD values to differ from the API.

### Data Notes

- **Early History**: For dates with less than 30 days of historical data, the APR is calculated using all available days and annualized accordingly.
- **Price Data Source**: Daily `assets.json` files containing TUNA prices derived from on-chain swap transaction data
- **Revenue Validation**: All revenue figures are validated against the DefiTuna public API to ensure 100% accuracy.
- **USD Values**: Calculated using daily spot market rates from the DefiTuna API, ensuring exact match with protocol's official USD values.

## Understanding the Chart

The chart displays:
- **X-axis**: Date
- **Y-axis**: APR in percentage
- **Traces**:
  - **Reference APR** (teal line): APR based on current market price
  - **Your APR / Custom APR** (green dashed line): APR based on your entry price (default $0.05)
- **Hover**: Shows detailed breakdown including:
  - Reference APR and Your/Custom APR percentages
  - Number of days in rolling window
  - Rolling revenue (SOL and USD)
  - TUNA Reference Price in USD (from on-chain swap data)

The APR naturally fluctuates based on:
1. **Treasury Revenue**: Higher protocol activity increases treasury inflows
2. **TUNA Price**: Price movements affect the Reference APR calculation
3. **Your Entry Price**: Lower entry prices result in higher Your APR for the same revenue
4. **Historical Window**: Early days with less historical data may show higher volatility

## Personalized APR Feature

The dashboard allows you to calculate your personalized APR based on your actual TUNA entry price.

### How It Works

**Formula**:
```
Custom APR (%) = (Revenue per TUNA in USD / Your Entry Price in USD) × 100
```

**Default**: If no price is entered, defaults to $0.05 (public pre-sale price).

**Example**:
- Market TUNA price: $0.20
- Your entry price: $0.05
- Revenue per TUNA: $0.012

Reference APR: ($0.012 / $0.20) × 100 = **6.0%**
Custom APR: ($0.012 / $0.05) × 100 = **24.0%**

### Features

- **Interactive Input**: Enter your entry price below the chart
- **Dual Chart Traces**: Green dashed line shows your personalized APR
- **Summary Stats**: Each stat card displays both Reference and Custom APR
- **localStorage Persistence**: Your entry price is saved across sessions
- **Real-time Updates**: Chart updates immediately when you change the price

### Why This Matters

If you purchased TUNA at a lower price than the current market price, your effective APR is higher because:
- The protocol revenue is the same
- But your cost basis was lower
- Therefore, your return on investment is higher

This feature helps you understand your actual yield based on your investment, not just the market yield.

## Technical Details

For developers and technical users interested in how the APR calculation works:

- **Backend Documentation**: See `docs/APY_CALCULATION_SYSTEM.md` in the `solana_analytics` repository for complete technical details
- **Component Source**: `frontend/src/components/Dashboard/ApyChart.tsx`
- **Data Source**: `frontend/static/data/apr_data.json` (generated by `tools/compute_apy_data.py`)
- **Price Source**: `cache/{address}/{year}/{month}/{date}.assets.json` (on-chain derived prices)

### Data Update Frequency

The APR data is manually updated when:
- New treasury transaction data is loaded
- Assets analysis generates new daily price data
- USD/SOL exchange rates change significantly

For the most current data, check the "Last updated" timestamp in the site header.
