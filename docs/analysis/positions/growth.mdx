---
title: Open Positions Analysis
description: Track active DefiTuna LP positions over time
sidebar_position: 1
---

import BrowserOnly from '@docusaurus/BrowserOnly';
import positionMetrics from '@site/static/data/position_metrics.json';

# Open Positions Analysis

This page tracks active liquidity provider (LP) positions on DefiTuna, showing how many positions are open at each point in time from July 24, 2025 through the latest available data.

## Overview

The position registry tracks all LP position openings and closures across DefiTuna's Orca and Fusion pools. This data powers wallet revenue attribution by mapping positions to their owners.

**Registry Coverage**: The full registry contains **10,774 unique positions**, of which:
- **6,853 positions** were opened during the tracking period (shown in metrics below)
- **3,921 positions** were already open when tracking began (included in daily counts)
- **2,286 positions** have been closed since tracking started

<div style={{marginBottom: '24px', padding: '16px', background: 'var(--ifm-background-surface-color)', border: '1px solid var(--ifm-toc-border-color)', borderRadius: 'var(--ifm-global-radius)'}}>

### Key Metrics

<div style={{display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '16px'}}>
  <div>
    <div style={{fontSize: '0.875rem', color: 'var(--ifm-color-gray-600)', marginBottom: '4px'}}>Total Positions Opened</div>
    <div style={{fontSize: '1.75rem', fontWeight: 'bold', color: 'var(--ifm-color-primary)'}}>{positionMetrics.daily_metrics[positionMetrics.daily_metrics.length - 1].cumulative_opened.toLocaleString()}</div>
  </div>

  <div>
    <div style={{fontSize: '0.875rem', color: 'var(--ifm-color-gray-600)', marginBottom: '4px'}}>Total Positions Closed</div>
    <div style={{fontSize: '1.75rem', fontWeight: 'bold', color: 'var(--ifm-color-danger)'}}>{positionMetrics.daily_metrics[positionMetrics.daily_metrics.length - 1].cumulative_closed.toLocaleString()}</div>
  </div>

  <div>
    <div style={{fontSize: '0.875rem', color: 'var(--ifm-color-gray-600)', marginBottom: '4px'}}>Currently Open</div>
    <div style={{fontSize: '1.75rem', fontWeight: 'bold', color: 'var(--ifm-color-success)'}}>{positionMetrics.daily_metrics[positionMetrics.daily_metrics.length - 1].net_open.toLocaleString()}</div>
  </div>

  <div>
    <div style={{fontSize: '0.875rem', color: 'var(--ifm-color-gray-600)', marginBottom: '4px'}}>Closure Rate</div>
    <div style={{fontSize: '1.75rem', fontWeight: 'bold', color: 'var(--ifm-color-primary)'}}>
      {((positionMetrics.daily_metrics[positionMetrics.daily_metrics.length - 1].cumulative_closed / positionMetrics.daily_metrics[positionMetrics.daily_metrics.length - 1].cumulative_opened) * 100).toFixed(1)}%
    </div>
  </div>
</div>

</div>

## Open Positions Over Time

This chart shows the number of **active LP positions** at each point in time. The shaded area represents positions that are currently open (not yet closed or liquidated).

**Additional traces** (hidden by default, click legend to show):
- **Daily Opened** (green dotted line): New positions opened each day
- **Daily Closed** (red dotted line): Positions closed each day

<BrowserOnly fallback={<div style={{padding: '48px', textAlign: 'center', color: 'var(--ifm-color-secondary)'}}>Loading chart...</div>}>
  {() => {
    const PositionGrowthChart = require('@site/src/components/Positions/PositionGrowthChart').default;
    return <PositionGrowthChart data={positionMetrics.daily_metrics} />;
  }}
</BrowserOnly>

## Insights

### IDL Change Detection

Around September 9, 2025, DefiTuna updated their program IDL with new instruction names. Our position registry correctly handles both old and new instruction formats:

- **Pre-September**: `InitializePosition`, `OpenPositionWithLiquidityOrca`, `LiquidatePositionOrca`
- **Post-September**: `OpenAndIncreaseTunaLpPositionOrca`, `LiquidateTunaLpPositionOrca`

This ensures complete position tracking across the entire history.

### Position Lifecycle

The chart starts with **3,921 pre-existing positions** that were already open before tracking began. As new positions open and old ones close, the net open count fluctuates based on:
- **New position creation**: Users opening new LP positions with capital
- **Position closures**: Manual withdrawals, liquidations, stop-loss, or take-profit triggers

The current closure rate of ~33% indicates that roughly one-third of all positions opened during tracking have been exited.

### Volatility Events

Spikes in closures often correspond to market volatility events where liquidations increase. The October 10, 2025 event saw 168 position closures (2.4x normal daily volume).

## Data Source

Position data is extracted from the DefiTuna treasury transaction cache, tracking:
- Position openings with rent-based account detection
- Position adjustments (increase/decrease liquidity)
- Position closures (manual, liquidation, stop-loss, take-profit)

Generated: {new Date(positionMetrics.metadata.generated_at).toLocaleDateString()} at {new Date(positionMetrics.metadata.generated_at).toLocaleTimeString()}
